<main class="teams-shell">
  <header class="teams-topbar">
    <div>
      <p class="eyebrow">Teams</p>
      <h1>Organization teams</h1>
      <p class="subtitle">Track structure, headcount, and coverage by team.</p>
    </div>
    <div class="actions">
      <a class="ghost button-link" routerLink="/">Back to home</a>
      <button class="primary" type="button" (click)="openCreateTeam()">Create team</button>
    </div>
  </header>

  <section class="teams-grid">
    @for (team of teams; track team.name) {
      <article class="panel">
        <div class="panel-header">
          <h2>{{ team.name }}</h2>
          <span class="pill" [class.soft]="team.people < 100"
            >{{ team.people }} people</span
          >
        </div>
        <p>{{ team.summary }}</p>
        <div class="team-meta">
          <div>
            <span class="label">Manager</span>
            <span class="value">{{ team.head }}</span>
          </div>
          <div>
            <span class="label">Coverage</span>
            <span class="value">{{ team.coverage }}</span>
          </div>
          <div>
            <span class="label">Sites</span>
            <span class="value">{{ team.sites }}</span>
          </div>
        </div>
        <button class="ghost full" type="button" (click)="openRoster(team.name)"
          >View roster</button
        >
      </article>
    }
  </section>
</main>

@if (createOpen) {
  <div class="modal-backdrop" (click)="closeCreateTeam()"></div>
  <div class="modal large" role="dialog" aria-modal="true">
    <header>
      <div>
        <p class="eyebrow">Teams</p>
        <h3>Create team</h3>
        <p class="subtitle">Add a new department and ownership details.</p>
      </div>
      <button class="ghost" type="button" (click)="closeCreateTeam()">Close</button>
    </header>
    <form class="form-grid">
      <label>
        Team name
        <input type="text" [(ngModel)]="form.name" name="team-name" required />
      </label>
      <label>
        Team head
        <input type="text" [(ngModel)]="form.head" name="team-head" required />
      </label>
      <label class="full">
        Summary
        <textarea [(ngModel)]="form.summary" name="team-summary" rows="2"></textarea>
      </label>
      <label>
        People count
        <input type="number" [(ngModel)]="form.people" name="team-people" min="0" />
      </label>
      <label>
        Coverage
        <input type="text" [(ngModel)]="form.coverage" name="team-coverage" />
      </label>
      <label class="full">
        Sites
        <input type="text" [(ngModel)]="form.sites" name="team-sites" />
      </label>
    </form>
    <div class="modal-actions">
      <button class="ghost" type="button" (click)="closeCreateTeam()">Cancel</button>
      <button class="primary" type="button" (click)="createTeam()">Save team</button>
    </div>
  </div>
}

@if (selectedTeam) {
  <div class="modal-backdrop" (click)="closeRoster()"></div>
  <div class="modal" role="dialog" aria-modal="true">
    <header>
      <div>
        <p class="eyebrow">Team roster</p>
        <h3>{{ selectedTeam.name }}</h3>
        <p class="subtitle">Head: {{ selectedTeam.head }}</p>
      </div>
      <button class="ghost" type="button" (click)="closeRoster()">Close</button>
    </header>
    <div class="modal-body">
      @if (selectedTeam.roster.length) {
        @for (member of selectedTeam.roster; track member.name) {
          <div class="member-row">
            <div>
              <strong>{{ member.name }}</strong>
              <span>{{ member.role }}</span>
            </div>
            <span class="pill soft">{{ member.location }}</span>
          </div>
        }
      } @else {
        <p class="empty">No team members added yet.</p>
      }
    </div>
  </div>
}
