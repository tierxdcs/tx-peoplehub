<div class="app-shell">
  @if (showChrome) {
    <header class="app-topbar">
      <div class="brand">
        <span class="product">tx-peoplehub</span>
        <span class="org">TierX Data Center Solutions</span>
      </div>
      <nav class="nav">
        <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }"
          >People</a
        >
        <a routerLink="/admin" routerLinkActive="active">Admin</a>
        <a routerLink="/settings" routerLinkActive="active">Settings</a>
      </nav>
      <div class="actions">
        <button
          class="ghost icon-button"
          type="button"
          aria-label="Notifications"
          (click)="toggleNotifications()"
        >
          <span aria-hidden="true">ðŸ””</span>
          @if (notifications.length) {
            <span class="notification-badge">{{ notifications.length }}</span>
          }
        </button>
        @if (notificationsOpen) {
          <div class="notifications-panel" role="dialog" aria-label="Notifications">
            <div class="notifications-header">
              <strong>Alerts</strong>
              <span>{{ notifications.length }} new</span>
            </div>
            <div class="notifications-list">
              @if (notifications.length) {
                @for (note of notifications; track note.message) {
                  <div class="notification-item">
                    <p>{{ note.message }}</p>
                    <span>{{ note.category }}</span>
                  </div>
                }
              } @else {
                <div class="notification-item">
                  <p>No new alerts.</p>
                  <span>All caught up</span>
                </div>
              }
            </div>
          </div>
        }
        <button class="avatar" type="button" aria-label="Account" (click)="toggleAvatarMenu()">
          {{ avatarInitials }}
        </button>
        @if (avatarOpen) {
          <div class="account-panel" role="dialog" aria-label="Account options">
            <div class="account-header">
              <strong>{{ session.name }}</strong>
              <span>{{ session.role }}</span>
            </div>
            <div class="account-actions">
              <a class="ghost button-link" routerLink="/people/current">My profile</a>
              <button class="ghost" type="button" (click)="logout()">Logout</button>
            </div>
          </div>
        }
      </div>
    </header>
  }

  @if (isLoading) {
    <div class="global-loader" role="status" aria-live="polite">
      <div class="loader-card">
        <span class="spinner" aria-hidden="true"></span>
        <div>
          <strong>Loading</strong>
          <span>Fetching latest data</span>
        </div>
      </div>
    </div>
  }

  <main class="app-content" [class.no-topbar]="!showChrome">
    <router-outlet />
  </main>

  @if (showChrome) {
    <footer class="app-footer">
      Proudly developed by TierX DCS | 2026
    </footer>
  }
</div>
