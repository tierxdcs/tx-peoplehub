<main class="reimburse-shell">
  <header class="reimburse-topbar">
    <div>
      <p class="eyebrow">Reimbursement</p>
      <h1>Expense reimbursements</h1>
      <p class="subtitle">Submit expenses and track approval status.</p>
    </div>
    <div class="actions">
      <a class="ghost button-link" routerLink="/">Back to home</a>
    </div>
  </header>

  <section class="reimburse-grid">
    <article class="panel form-panel">
      <div class="panel-header">
        <h2>New reimbursement</h2>
        <span class="pill">Required</span>
      </div>
      <form class="form-grid">
        <label>
          Title
          <input type="text" [(ngModel)]="form.title" name="title" placeholder="Client travel" />
        </label>
        <label>
          Amount (₹)
          <input type="number" [(ngModel)]="form.amount" name="amount" placeholder="1250" />
        </label>
        <label>
          Category
          <select [(ngModel)]="form.category" name="category">
            <option>Travel</option>
            <option>Meals</option>
            <option>Supplies</option>
            <option>Training</option>
          </select>
        </label>
        <label>
          Date
          <input type="date" [(ngModel)]="form.date" name="date" />
        </label>
        <label class="full">
          Notes
          <textarea rows="4" [(ngModel)]="form.notes" name="notes"></textarea>
        </label>
        <div class="full approver-note">
          Routed to approver: Chief Operating Officer (COO)
        </div>
      </form>
      <button class="primary full" type="button" (click)="submit()">
        Submit reimbursement
      </button>
      @if (statusMessage) {
        <p class="status">{{ statusMessage }}</p>
      }
    </article>

    <article class="panel">
      <div class="panel-header">
        <h2>Recent claims</h2>
        <span class="pill">This month</span>
      </div>
      <div class="claim-list">
        @for (claim of claims; track claim.title) {
          <div class="claim-row" (click)="showApprovedMessage(claim)">
            <div>
              <strong>{{ claim.title }}</strong>
              <span>{{ claim.submitted }}</span>
              @if (claim.notes) {
                <small>{{ claim.notes }}</small>
              }
            </div>
            <div class="meta">
              <span class="amount">{{ claim.amount }}</span>
              <span class="status">{{ claim.status }}</span>
            </div>
          </div>
        } @empty {
          <p class="empty">No reimbursements submitted yet.</p>
        }
        @if (approvedMessage) {
          <p class="status">{{ approvedMessage }}</p>
        }
      </div>
    </article>

    <article class="panel">
      <div class="panel-header">
        <h2>Policy summary</h2>
        <span class="pill soft">FY26</span>
      </div>
      <div class="detail">
        <span class="label">Approver</span>
        <span class="value">Chief Operating Officer (COO)</span>
      </div>
      <div class="detail">
        <span class="label">Monthly cap</span>
        <span class="value">₹5,000</span>
      </div>
      <div class="detail">
        <span class="label">Home office</span>
        <span class="value">Not-Eligible</span>
      </div>
      <div class="detail">
        <span class="label">Travel</span>
        <span class="value">Pre-approval required</span>
      </div>
    </article>
  </section>
</main>

@if (showSuccessModal) {
  <div class="modal-backdrop" (click)="closeSuccessModal()"></div>
  <div class="modal" role="dialog" aria-modal="true">
    <header>
      <div>
        <p class="eyebrow">Reimbursement</p>
        <h3>Claim submitted</h3>
        <p class="subtitle">Your reimbursement request is now pending approval.</p>
      </div>
      <button class="ghost" type="button" (click)="closeSuccessModal()">Close</button>
    </header>
    <div class="modal-actions">
      <button class="primary" type="button" (click)="closeSuccessModal()">Done</button>
    </div>
  </div>
}
